# teamproject_qna
은행 문의 답변 프로젝트


```
사용 문의 쓰면 - 예금
예금 담당 문의 매니저가 해당 문의를 작성

예금 매니저는 예금 담당 문의만 볼수 있음

===============

database
oracle db

우선 순위
web

인증, 인가
jwt 방식
패스워드 암호화 - bCrypt

후순위
문의 - pagination


매니저는 /admin으로 다르게 구성

라이브러리
jpa
spring web
oracle driver
lombok
devtool
thymeleaf
bcrypt - 암호화
jwt관련 라이브러리

깃


회원
uid
username
password
name
role


매니저
mid - pk - auto
uid - 외래키
job - (예금, 대출, 카드)

문의 테이블
bid
title
content
writer - uid - 외래키
category


답변 테이블
aid
content
writer - mid
bid - 외래키





화면 정의서

처음 페이지
    - 로그인 페이지
        - username, password 입력창
        - 로그인 하기 버튼
        - 회원가입 이동 버튼
        - 로그인 성공 시 문의 페이지로 이동
    회원가입 페이지
        - username
        - password
        - name
        - 회원가입 버튼
        - 로그인 이동 버튼
    문의 페이지
        - 폼 제공
            - title
            - content
            - writer 자동 제공
        - 카테고리(카드, 적금, 대출) 선택 하기
        - 등록하기 버튼(문의 등록)
        - 마이페이지 이동 버튼 제공
    마이 페이지
        - 회원이 등록한 문의 내역
        - 제목 누르면 상세 보기 제공
        - 문의 페이지 이동 버튼 제공
    상세 페이지
        - 회원이 작성한 문의 상세 정보
        - 매니저가 작성한 답변을 볼수 있음
        - 마이페이지 이동 버튼
    매니저 페이지
        - 전체 문의 내역 보기
        - 현재 매니저 직무 문의 내역 보기
        - 문의 제목 선택시 매니저용 상세 페이지 이동
    매니저 문의 상세 페이지
        - 문의 정보 상세 제공
        - 답변을 달수 있는 기능 제공


웹, 앱 둘다 개발이 되면 둘 다 개발
사용자가 로그인
회원 상담사를 제공함 - 회원만 가능인듯
상담에 대한 카테고리(예금, ) 등등
삼담사는 문의가 들어오면 처리를 함

매니저는 문의가 들어온 것을 처리해야 함

만약 여력이 된다면
로그인 할 떄 패스워드를 암호화
사용자 인가 인증을 jwt로 구현

```


## 📊 핵심 테이블 (3개만)

### 1. 회원 테이블 (Member) - 사용자 + 매니저 통합
| 컬럼명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 회원 고유 ID |
| username | VARCHAR(50) | UNIQUE, NOT NULL | 로그인 ID |
| password | VARCHAR(255) | NOT NULL | BCrypt 암호화 비밀번호 |
| name | VARCHAR(100) | NOT NULL | 이름 |
| role | VARCHAR(20) | NOT NULL | 'USER' 또는 'MANAGER' |
| job | VARCHAR(20) | | 매니저 담당업무 ('예금'/'대출'/'카드') |

**비즈니스 규칙:**
- `role = 'USER'` → `job = NULL`
- `role = 'MANAGER'` → `job` 필수

### 2. 문의 테이블 (Board)
| 컬럼명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 문의 고유 ID |
| title | VARCHAR(200) | NOT NULL | 문의 제목 |
| content | TEXT | NOT NULL | 문의 내용 |
| writer | BIGINT | FK, NOT NULL | 작성자 ID (Member.id) |
| category | VARCHAR(20) | NOT NULL | '예금'/'대출'/'카드' |

### 3. 답변 테이블 (Answer)
| 컬럼명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 답변 고유 ID |
| content | TEXT | NOT NULL | 답변 내용 |
| writer | BIGINT | FK, NOT NULL | 매니저 ID (Member.id) |
| board_id | BIGINT | FK, NOT NULL | 문의 ID (Board.id) |



## 💾 Oracle DDL (최소 버전)

```sql
-- 회원 테이블 (사용자 + 매니저 통합)
CREATE TABLE member (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) UNIQUE NOT NULL,
    password VARCHAR2(255) NOT NULL,
    name VARCHAR2(100) NOT NULL,
    role VARCHAR2(20) NOT NULL CHECK (role IN ('USER', 'MANAGER')),
    job VARCHAR2(20) CHECK (job IN ('예금', '대출', '카드'))
);

-- 문의 테이블
CREATE TABLE board (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title VARCHAR2(200) NOT NULL,
    content CLOB NOT NULL,
    writer NUMBER NOT NULL,
    category VARCHAR2(20) NOT NULL CHECK (category IN ('예금', '대출', '카드')),
    CONSTRAINT fk_board_writer FOREIGN KEY (writer) REFERENCES member(id)
);

-- 답변 테이블
CREATE TABLE answer (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    content CLOB NOT NULL,
    writer NUMBER NOT NULL,
    board_id NUMBER NOT NULL,
    CONSTRAINT fk_answer_writer FOREIGN KEY (writer) REFERENCES member(id),
    CONSTRAINT fk_answer_board FOREIGN KEY (board_id) REFERENCES board(id)
);
```

## 🔥 왜 이 설계가 좋은가?

### 1. 단순함
```java
// 매니저 확인 - 한 번의 쿼리
Member member = memberRepository.findById(id);
if ("MANAGER".equals(member.getRole()) && 
    "예금".equals(member.getJob())) {
    // 예금 담당 매니저
}
```

### 2. 성능
- JOIN 없음
- 테이블 3개만 관리
- 빠른 권한 체크

### 3. 확장성
```java
// 새로운 역할 추가 시
member.setRole("ADMIN");  // 간단!

// 새로운 업무 추가 시
member.setJob("보험");    // 간단!
```

## 📋 샘플 데이터

```sql
-- 일반 사용자
INSERT INTO member VALUES (1, 'user1', '$2a$10$...', '김고객', 'USER', NULL);

-- 매니저들
INSERT INTO member VALUES (2, 'manager1', '$2a$10$...', '박매니저', 'MANAGER', '예금');
INSERT INTO member VALUES (3, 'manager2', '$2a$10$...', '이매니저', 'MANAGER', '대출');

-- 문의
INSERT INTO board VALUES (1, '예금 문의', '예금 상품 궁금합니다', 1, '예금');

-- 답변
INSERT INTO answer VALUES (1, '예금 상품은...', 2, 1);
```

